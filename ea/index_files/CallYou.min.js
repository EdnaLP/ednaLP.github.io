var eaCmsApp=eaCmsApp||{};$(document).ready(function(){eaCmsApp.CallYou=function(){let e=$("#TlfEASF");const a=$("#ButtonToCallEASF");let n=$("[data-popUp-CallYouBody]");return{setOptions:function(){eaCmsApp.Configuration.getConfigurationValue("RestCountries").then(function(e){return fetch(e).then(eaCmsApp.Utils.handleErrors).then(function(e){return e.json()}).catch(function(a){eaCmsApp.Logger.error("Error when retrieving countprefix and codes from all countries",{error:a,url:e})})}).then(function(t){if(void 0!==t){let n=[],o=[];for(let e=0;e<t.length;e++)""!==t[e].callingCodes[0]&&null!==t[e].translations.es&&("esp"===t[e].alpha3Code.toLowerCase()?o.push({callingCode:t[e].callingCodes[0],flag:t[e].alpha3Code.toLowerCase(),name:t[e].translations.es}):n.push({callingCode:t[e].callingCodes[0],flag:t[e].alpha3Code.toLowerCase(),name:t[e].translations.es}));n.sort(function(e,a){let n=e.name.toLowerCase(),t=a.name.toLowerCase();return n<t?-1:n>t?1:0}),n=o.concat(n),$("#flagsAndNamesCountriesEASF").kendoDropDownList({dataTextField:"name",dataValueField:"callingCode",valueTemplate:'<div class="ea-flag-text-group"><span class="ea-flag-bullet" style="background-image: url(\'https://restcountries.eu/data/#:data.flag#.svg\')"></span><span>+#:data.callingCode#&nbsp;#:data.name#</span></div>',template:'<div class="ea-flag-text-group" data-element="country"><span class="ea-flag-bullet" style="background-image: url(\'https://restcountries.eu/data/#:data.flag#.svg\')"></span>  <span>+#:data.callingCode#&nbsp;&nbsp;#:data.name#</span></div>',dataSource:n,change:function(){$("#prefixSelectedEASF").val($("#flagsAndNamesCountriesEASF").val())},height:240}),$("#timeRangeEASF").kendoDropDownList({dataTextField:"range",dataValueField:"time",dataSource:[{range:resources.morning+" 9:00 - 13:00",time:resources.morning},{range:resources.afternoon+" 13:00 - 18:00",time:resources.afternoon},{range:resources.allDay+" 9:00 - 18:00",time:resources.allDay}],change:function(){$("#rangeSelectedEASF").val($("#timeRangeEASF").val())}}),e.bind("input",function(){$(this).val().match(/^\d{9}$/)?a.removeAttr("disabled"):a.attr("disabled",!0)}),a.click(()=>(function(){let e="/restapi/CallYou";fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({prefix:$("#prefixSelectedEASF").val(),range:$("#rangeSelectedEASF").val(),phoneNumber:$("#TlfEASF").val(),eMail:$("#mailToSendEASF").val()})}).then(eaCmsApp.Utils.handleErrors).then(function(){eaCmsApp.Logger.information("Successfully send prefix and phone number",{url:e}),eaCmsApp.Mail.showConfirmation()}).catch(function(a){eaCmsApp.Logger.error("Error when sending prefix and phone number",{error:a,url:e})})})())}else n.html(resources.unavailableSection)})}}}(),eaCmsApp.CallYou.setOptions()});